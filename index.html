<!DOCTYPE html>

<html lang="ja">
<head><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&amp;display=swap" rel="stylesheet"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>韓国語単語暗記ツール</title>
<style>body, header, h1, h2, h3, label, select, button {
  font-family: 'Noto Sans JP', sans-serif;
}

header h1 {
  font-size: 24px;
  margin: 0;
}

body {
  font-family: 'Noto Sans JP', sans-serif;
  background-color: #f9f9fb;
  margin: 0;
  padding: 0;
}
header {
  background-color: #333;
  color: #fff;
  padding: 15px 0;
  text-align: center;
  font-size: 28px;
}
.container {
  max-width: 600px;
  background-color: #fff;
  margin: 40px auto;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
}
h3 {
  margin-top: 15px;
  font-size: 20px;
  border-left: 6px solid #007BFF;
  padding-left: 10px;
}
button {
  display: inline-block;
  margin: 10px 5px 10px 0;
  padding: 12px 24px;
  font-size: 16px;
  font-weight: bold;
  color: #fff;
  background-color: #007BFF;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  transition: all 0.2s ease-in-out;
}
button:hover {
  background-color: #0056b3;
  transform: translateY(-1px);
}
.form-group {
  display: grid;
  grid-template-columns: 100px 1fr;
  align-items: center;
  gap: 10px;
  margin: 10px 0;
}
.form-group label {
  font-size: 14px;
  margin: 0;
  white-space: nowrap;
}
.form-group select {
  padding: 4px 8px;
  font-size: 14px;
}
.page-range {
  display: flex;
  align-items: center;
  gap: 5px;
}
.checkbox-group {
  margin: 10px 0;
}
.checkbox-group label {
  display: flex;
  align-items: center;
  font-size: 14px;
  gap: 5px;
}
select.level-select {
  width: 160px;
}

body {
      font-family: 'Noto Sans JP', sans-serif;
      background-color: #f9f9fb;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #333;
      color: #fff;
      padding: 15px 0;
      text-align: center;
      font-size: 24px;
    }
    .container {
      max-width: 600px;
      background-color: #fff;
      margin: 40px auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
    }
    h3 {
      margin-top: 15px;
      font-size: 20px;
      border-left: 6px solid #007BFF;
      padding-left: 10px;
    }
    button {
      display: inline-block;
      margin: 10px 5px 10px 0;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: bold;
      color: #fff;
      background-color: #007BFF;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: all 0.2s ease-in-out;
    }
    button:hover {
      background-color: #0056b3;
      transform: translateY(-1px);
    }
    .form-group {
      display: grid;
      grid-template-columns: 100px 1fr;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    .form-group label {
      font-size: 14px;
      margin: 0;
      white-space: nowrap;
    }
    .form-group select {
      padding: 4px 8px;
      font-size: 14px;
    }
    .page-range {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .checkbox-group {
      margin: 10px 0;
    }
    .checkbox-group label {
      display: flex;
      align-items: center;
      font-size: 14px;
      gap: 5px;
    }
    select.level-select {
    width: 160px; /* 表示ページセレクト2個＋～と同じくらいの幅に調整 */
    }

body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
        }
        header {
            background: #333;
            color: #fff;
            padding: 10px 0;
            text-align: center;
        }
        .container {
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
            background: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        button {
            display: inline-block;
            margin: 5px 0;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background: #007BFF;
            color: #fff;
            border: none;
            border-radius: 3px;
        }
        button:hover {
            background: #0056b3;
        }
        .hidden {
            display: none;
        }
        .modal-content button {
            margin: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background: #f4f4f9;
        }
        .scrollable-table {
            max-height: 450px;  /* テーブルの最大高さ */
            overflow-y: auto;   /* 縦スクロールを許可 */
            border: 1px solid #ddd;
            position: relative;
            padding: 0;
            margin: 0;
            -webkit-overflow-scrolling: touch;  /* iOSのスムーズスクロールを有効化 */
            touch-action: auto;  /* タッチスクロールを有効化 */
        }

        .scrollable-table table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            padding: 0;
        }

        .scrollable-table thead th {
            position: sticky;
            top: 0;
            background-color: #f4f4f4;
            z-index: 2;
            height: 30px;
            line-height: 30px;
        }
        td.green {
            color: green;
            background-color: #d4edda;
        }

        td.red {
            color: red;
            background-color: #f8d7da;
        }
        .hidden-korean {
            visibility: hidden;
        }

        .hidden-meaning {
            visibility: hidden;
        }
        #word-container {
            display: flex;
            align-items: center;
        }

        #word {
            margin-right: 2px; /* スピーカーアイコンとの間に適切なスペースを追加 */
        }
        table th, table td {
            height: 20px;   /* 各行の高さを50pxに設定 */
        }
        /* モーダルのスタイル */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.hidden {
            display: none;
        }

        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            width: 300px;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .modal-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        #modal-yes {
            background-color: #4CAF50;
            color: white;
        }

        #modal-no {
            background-color: #f44336;
            color: white;
        }
        .button-container {
            display: flex;
            justify-content: center;  /* 水平方向に中央揃え */
            align-items: center;      /* 垂直方向にも中央揃え */
            gap: 10px;
            margin-top: 20px;         /* ボタンとカードの間にスペースを追加（必要に応じて調整） */
        }


        #correct-btn, #incorrect-btn {
            font-size: 24px;
            width: 170px;            /* 幅を適切に設定 */
            height: 50px;           /* 高さを適切に設定 */
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            border-radius: 10px;
            line-height: 1;
            box-sizing: border-box;
        }

        #card {
            width: 100%;
            max-width: 310px;
            height: auto; /* 高さは内容に応じて可変 */
            margin: 20px auto;
            padding: 20px;
            background-color: #e0e0e0; /* グレーのカード色 */
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column; /* 縦に並べる */
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

#word-container {
    display: flex;
    justify-content: center;  /* 単語を中央揃え */
    align-items: center;
    width: 100%;  /* 親要素の幅を均等に */
}

#word-wrapper {
    display: flex;
    align-items: center;  /* 単語と🔊を縦中央揃え */
    justify-content: center;  /* 🔊マークを単語の右に配置 */
    gap: 8px;  /* 単語と🔊マークの間隔 */
    min-width: 200px;  /* 単語の幅を一定にし、意味と揃えやすくする */
}

#word {
    font-size: 24px;
    font-weight: bold;
    text-align: center;
    white-space: nowrap;  /* 長い単語でも折り返さない */
}

#speaker-icon {
    font-size: 20px;
    cursor: pointer;
}

#meaning {
    display: block;
    font-size: 18px;
    color: #555;
    text-align: center;  /* 単語の意味も中央揃え */
    margin-top: 10px;
    min-width: 200px;  /* `#word-wrapper` と同じ幅を設定 */
}
.progress-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
/* 〇×ボタンの下に黒線を引いて、矢印ボタンを配置 */
.button-container {
    display: flex;
    justify-content: center;  /* 水平方向に中央揃え */
    align-items: center;      /* 垂直方向にも中央揃え */
    gap: 10px;
    margin-top: 20px;         /* ボタンとカードの間にスペースを追加（必要に応じて調整） */
}

/* 黒線を引くためのスタイル */
.line-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    margin-top: 10px; /* ボタンと黒線の間にスペース */
}

/* 黒線 */
.black-line {
    width: 100%;
    height: 2px;
    background-color: rgba(0, 0, 0, 0.1);  /* 薄い黒線 */
    margin-bottom: 10px;  /* 黒線と矢印ボタンの間にスペース */
}

/* 矢印ボタンのスタイル */
.arrows-container {
    display: flex;
    justify-content: space-between;
    width: 100%;  /* 親要素いっぱいに広がる */
    padding: 0 10px;  /* 両端に適切な余白を追加 */
}
.word-list-controls {
    display: flex;
    justify-content: space-between; /* 左右に配置 */
    align-items: center; /* 高さを揃える */
    width: 100%; /* 横幅いっぱいに広げる */
    margin-top: 10px; /* テーブルとの間隔 */
}

.word-list-buttons {
    display: flex;
    gap: 10px; /* ボタン同士の間隔 */
}

.word-list-buttons button {
    padding: 5px 10px;
    font-size: 20px;
}
#toast {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background-color: #333;
    color: #fff;
    padding: 12px 20px;
    border-radius: 8px;
    font-size: 14px;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    z-index: 9999;
}
#toast.show {
    opacity: 1;
}

    .container {
      max-width: 600px;
      background-color: #fff;
      margin: 40px auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
    }
    h3 {
      margin-top: 15px;
      font-size: 20px;
      border-left: 6px solid #007BFF;
      padding-left: 10px;
    }
    .form-group {
      display: grid;
      grid-template-columns: 100px 1fr;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    .form-group label {
      font-size: 14px;
      margin: 0;
      white-space: nowrap;
    }
    .form-group select {
      padding: 4px 8px;
      font-size: 14px;
    }
    .page-range {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .page-range select {
      width: 60px;
    }
    .level-select {
      width: 160px;
    }
    .checkbox-group {
      margin: 10px 0;
    }
    .checkbox-group label {
      display: flex;
      align-items: center;
      font-size: 14px;
      gap: 5px;
    }
/* 表現力UPモード時に単語一覧の文字を小さくする */
#scrollable-table.small-text-mode table {
  font-size: 12px;
}

</style>
</head>
<body>
<header>
<h1>韓国語単語暗記ツール</h1>
</header>
<div class="container">
<!-- 出題範囲選択 -->
<div class="section" id="range-selection"><h3>📋 単語一覧表示</h3><button id="word-list-show-btn">単語一覧を見る</button>
<div class="form-group">
<label for="wordlist-level-select">難易度:</label>
<select class="level-select" id="wordlist-level-select">
<option value="beginner">初級</option>
<option value="intermediate">中級</option>
<option value="advanced">上級</option>
<option value="expressionup">表現力UP</option>
</select>
</div>
<div class="form-group">
<label>表示ページ:</label>
<div class="page-range">
<select id="wordlist-start-page"></select>
<span>～</span>
<select id="wordlist-end-page"></select>
</div>
</div>
<div class="checkbox-group">
<label><input id="wordlist-shuffle" type="checkbox"/> 単語をランダムに並び替えて表示</label>
</div>
<h3>🃏 フラッシュカード出題</h3><button onclick="startQuiz()">フラッシュカード開始</button>
<div class="form-group">
<label for="quiz-level-select">難易度:</label>
<select class="level-select" id="quiz-level-select">
<option value="beginner">初級</option>
<option value="intermediate">中級</option>
<option value="advanced">上級</option>
<option value="expressionup">表現力UP</option>
</select>
</div>
<div class="form-group">
<label>出題ページ:</label>
<div class="page-range">
<select id="start-page"></select>
<span>～</span>
<select id="end-page"></select>
</div>
</div>
<div class="checkbox-group">
<label><input id="only-incorrect" type="checkbox"/> 未暗記の単語一覧からのみ出題する</label>
<label><input id="auto-speak" onchange="toggleAutoSpeak()" type="checkbox"/> 自動読み上げ機能をONにする</label>
</div>
<div>
<button onclick="exportProgress()">暗記状況を保存</button>
<input accept=".json" id="import-file" onchange="importProgress(event)" style="display:none;" type="file"/>
<button onclick="document.getElementById('import-file').click()">暗記状況を読み込む</button>
</div>
</div>
<!-- 出題セクション -->
<div class="section hidden" id="quiz-section">
<!-- 進行状況と戻るボタンを横並びにするためのコンテナ -->
<div class="progress-container">
<span>進行状況: <span id="progress">0/0</span></span>
<button onclick="showRangeSelection()">戻る</button>
</div>
<div id="card">
<div id="word-container">
<div id="word-wrapper">
<span id="word">ここに単語が表示されます</span>
<span id="speaker-icon" onclick="playWord(document.getElementById('word').textContent)">🔊</span>
</div>
</div>
<div id="meaning">（意味が表示されます）</div>
</div>
<div class="button-container">
<button id="incorrect-btn" onclick="markAnswer(false)">×</button>
<button id="correct-btn" onclick="markAnswer(true)">⚪︎</button>
<button id="next-btn" onclick="nextQuestion()" style="display: none;">次へ</button>
</div>
<!-- ここに黒線と矢印ボタンを配置 -->
<div class="line-container">
<div class="black-line"></div> <!-- 薄い黒線 -->
<div class="arrows-container">
<button id="prev-btn" onclick="moveToPrevious()">←</button>
<button id="next-btn" onclick="moveToNext()">→</button>
</div>
</div>
<p id="result"></p>
</div>
<!-- 単語一覧表示 -->
<div class="table-container hidden" id="word-list">
<h2>単語一覧</h2>
<div>
<label>
<input id="hide-correct" onchange="filterWordList()" type="checkbox"/> 暗記済非表示
                </label>
<label>
<input id="hide-incorrect" onchange="filterWordList()" type="checkbox"/> 未暗記非表示
                </label>
<label>
<input id="hide-unattempted" onchange="filterWordList()" type="checkbox"/> 未解答非表示
                </label>
</div>
<div class="scrollable-table" id="scrollable-table" tabindex="0">
<table>
<thead>
<tr>
<th>
                                単語
                                <label>
<input id="toggle-korean" onchange="toggleKorean()" type="checkbox"/> 非表示
                                </label>
</th>
<th>
                                意味
                                <label>
<input id="toggle-meaning" onchange="toggleMeaning()" type="checkbox"/> 非表示
                                </label>
</th>
<th>暗記状況</th>
</tr>
</thead>
<tbody id="word-list-body">
<!-- 動的に生成される内容 -->
</tbody>
</table>
</div>
<div class="word-list-controls">
<button onclick="showRangeSelection()">戻る</button>
<div class="word-list-buttons">
<button id="up-button" onclick="playPreviousWord()">↑</button>
<button id="down-button" onclick="playNextWord()">↓</button>
<button id="repeat-button" onclick="repeatLastWord()">♻︎</button>
</div>
</div>
</div>
<!-- モーダル -->
<div class="modal hidden" id="quiz-modal">
<div class="modal-content">
<p id="modal-message">前回途中で終了したクイズがあります。再開しますか？※Noを選択すると履歴がリセットされます。</p>
<div class="modal-buttons">
<button id="modal-no">No</button>
<button id="modal-yes">Yes</button>
</div>
</div>
</div>
<div class="hidden" id="toast"></div><div class="hidden" id="json-output" style="margin-top:20px;"><p>🔒 進捗データを下からコピーして、メモ帳やiCloud Driveに貼り付けて保存してください。</p><textarea id="json-text" readonly="" rows="10" style="width:100%; font-family: monospace; font-size:14px;"></textarea><button onclick="copyToClipboard()" style="margin-top: 10px;">コピーする</button></div>
<script>
        // JSONデータ（例: PDFから抽出されたデータ）
        const beginnerWords = [
{"word": "가게", "meaning": "店", "page": 1},

];
const intermediateWords = [
{"word": "가계부", "meaning": "家計簿", "page": 1},

];

const advancedWords = [
  {"word": "심층", "meaning": "深層", "page": 1},
  {"word": "검토", "meaning": "検討", "page": 1},
  {"word": "촉진", "meaning": "促進", "page": 1},
  {"word": "승인", "meaning": "承認", "page": 1},
  {"word": "변수", "meaning": "変数", "page": 1},
  {"word": "통합", "meaning": "統合", "page": 2},
  {"word": "분석", "meaning": "分析", "page": 2},
  {"word": "지표", "meaning": "指標", "page": 2},
  {"word": "정책", "meaning": "政策", "page": 2},
  {"word": "전환", "meaning": "転換", "page": 2}
];


const expressionUpWords = [
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 1
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 1
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 1
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 1
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 1
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 1
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 1
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 1
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 1
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 1
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 1
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 1
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 1
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 1
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 1
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 1
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 1
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 1
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 1
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 1
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 2
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 2
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 2
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 2
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 2
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 2
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 2
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 2
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 2
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 2
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 2
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 2
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 2
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 2
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 2
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 2
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 2
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 2
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 2
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 2
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 3
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 3
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 3
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 3
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 3
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 3
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 3
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 3
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 3
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 3
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 3
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 3
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 3
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 3
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 3
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 3
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 3
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 3
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 3
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 3
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 4
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 4
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 4
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 4
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 4
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 4
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 4
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 4
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 4
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 4
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 4
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 4
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 4
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 4
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 4
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 4
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 4
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 4
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 4
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 4
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 5
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 5
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 5
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 5
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 5
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 5
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 5
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 5
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 5
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 5
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 5
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 5
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 5
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 5
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 5
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 5
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 5
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 5
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 5
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 5
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 6
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 6
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 6
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 6
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 6
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 6
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 6
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 6
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 6
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 6
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 6
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 6
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 6
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 6
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 6
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 6
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 6
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 6
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 6
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 6
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 7
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 7
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 7
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 7
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 7
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 7
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 7
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 7
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 7
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 7
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 7
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 7
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 7
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 7
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 7
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 7
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 7
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 7
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 7
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 7
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 8
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 8
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 8
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 8
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 8
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 8
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 8
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 8
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 8
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 8
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 8
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 8
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 8
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 8
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 8
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 8
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 8
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 8
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 8
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 8
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 9
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 9
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 9
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 9
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 9
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 9
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 9
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 9
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 9
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 9
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 9
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 9
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 9
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 9
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 9
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 9
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 9
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 9
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 9
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 9
  },
  {
    "word": "말이 씨가 된다",
    "meaning": "言葉が種になる → 言ったことが現実になる<br>例）농담으로 한 말인데 진짜 그렇게 돼서 말이 씨가 됐어.",
    "page": 10
  },
  {
    "word": "손에 물 한 방울 안 묻히다",
    "meaning": "手に水一滴もつけない → 何もさせない・お姫様扱い<br>例）결혼 후에도 손에 물 한 방울 안 묻히게 한다고 하더라.",
    "page": 10
  },
  {
    "word": "코앞이다",
    "meaning": "鼻先だ → すぐ近く・目前<br>例）시험이 코앞인데 공부가 안 돼.",
    "page": 10
  },
  {
    "word": "길눈이 어둡다",
    "meaning": "道の目が暗い → 方向音痴<br>例）나 길눈이 어두워서 또 길 잃었어.",
    "page": 10
  },
  {
    "word": "속을 뒤집다",
    "meaning": "中身をひっくり返す → イライラさせる<br>例）그 사람 말투는 진짜 속 뒤집어.",
    "page": 10
  },
  {
    "word": "말꼬리를 흐리다",
    "meaning": "言葉の尻を濁す → はっきり言わない<br>例）왜 자꾸 말꼬리를 흐려?",
    "page": 10
  },
  {
    "word": "눈이 높다",
    "meaning": "目が高い → 理想が高い<br>例）걔는 눈이 높아서 쉽게 만족 안 해.",
    "page": 10
  },
  {
    "word": "뼈가 있다",
    "meaning": "骨がある → 含みのある言葉<br>例）그 말엔 뼈가 있더라.",
    "page": 10
  },
  {
    "word": "도둑이 제 발 저리다",
    "meaning": "泥棒が自分の足をしびれさせる → 後ろめたい人が反応する<br>例）아무도 안 물었는데 혼자 변명하네? 도둑이 제 발 저린 거 아냐?",
    "page": 10
  },
  {
    "word": "배보다 배꼽이 크다",
    "meaning": "おへそが腹より大きい → 本末転倒<br>例）선물보다 포장비가 더 비싸! 배보다 배꼽이 크잖아.",
    "page": 10
  },
  {
    "word": "속이 울렁거리다",
    "meaning": "胸がムカムカする → 吐き気がする／気持ち悪い<br>例）멀미가 나서 속이 울렁거려.",
    "page": 10
  },
  {
    "word": "기가 막히다",
    "meaning": "呆れる／すごすぎて言葉が出ない<br>例）그 사람 진짜 기가 막힌 아이디어 내더라.",
    "page": 10
  },
  {
    "word": "뒤죽박죽이다",
    "meaning": "めちゃくちゃだ／ぐちゃぐちゃだ<br>例）방이 너무 어질러져서 완전 뒤죽박죽이야.",
    "page": 10
  },
  {
    "word": "입이 떨어지지 않다",
    "meaning": "口が離れない → 言い出しにくい<br>例）미안하다고 말하고 싶은데 입이 안 떨어져.",
    "page": 10
  },
  {
    "word": "귀가 간지럽다",
    "meaning": "耳がかゆい → 噂されている気がする<br>例）누가 내 얘기 하나 봐. 귀가 간질간질해.",
    "page": 10
  },
  {
    "word": "손이 꽉 차다",
    "meaning": "手がいっぱい → 手一杯だ<br>例）요즘은 일 때문에 손이 꽉 차 있어.",
    "page": 10
  },
  {
    "word": "눈살을 찌푸리다",
    "meaning": "眉をひそめる → 不快に思う<br>例）그런 말 들으면 누구든 눈살을 찌푸릴 거야.",
    "page": 10
  },
  {
    "word": "머리를 식히다",
    "meaning": "頭を冷やす → 気分転換する<br>例）좀 걸으면서 머리 식히고 와.",
    "page": 10
  },
  {
    "word": "코웃음을 치다",
    "meaning": "鼻で笑う → あざける<br>例）내가 한다니까 코웃음 쳤어.",
    "page": 10
  },
  {
    "word": "바람을 쐬다",
    "meaning": "風に当たる → 外に出て気分転換する<br>例）기분 전환하려고 잠깐 바람 좀 쐬고 왔어.",
    "page": 10
  }
];
let completed = false;
// どの単語リストを使うか選択するオプション（例: 変数selectedListを使用）
let selectedList = intermediateWords; // 初期状態は中級単語を使う

// 出題範囲に基づく単語リストを取得
function getWordsInRange(start, end, onlyIncorrect) {
    // 現在選択されている単語リスト（selectedList）を使ってフィルタリング
    return selectedList.filter(word => word.page >= start && word.page <= end && (!onlyIncorrect || word.status === "未暗記"));
}

// 出題範囲選択に応じてリストを切り替える処理を追加


function setWordList(listType) {
  if (listType === 'beginner') {
    selectedList = beginnerWords;
  } else if (listType === 'intermediate') {
    selectedList = intermediateWords;
  } else if (listType === 'advanced') {
    selectedList = advancedWords;
  } else if (listType === 'expressionup') {
    selectedList = expressionUpWords;
  }

  const tableContainer = document.getElementById('scrollable-table');
  if (tableContainer) {
    if (listType === 'expressionup') {
      tableContainer.classList.add('small-text-mode');
    } else {
      tableContainer.classList.remove('small-text-mode');
    }
  }
  else if (listType === 'intermediate') {
    selectedList = intermediateWords;
  } else if (listType === 'advanced') {
    selectedList = advancedWords;
  } else {
    selectedList = expressionUpWords;
  }
}


// 出題範囲選択に基づくページ範囲の変更

function updatePageRange() {
  const level = document.getElementById("quiz-level-select").value;
  let maxPage = 1;
  if (level === "beginner") {
    maxPage = 21;
  } else if (level === "intermediate") {
    maxPage = 34;
  } else if (level === "advanced") {
    maxPage = 2;
  } else if (level === "expressionup") {
    maxPage = 10;
  }

  const startPageSelect = document.getElementById("start-page");
  const endPageSelect = document.getElementById("end-page");

  startPageSelect.innerHTML = "";
  endPageSelect.innerHTML = "";

  for (let i = 1; i <= maxPage; i++) {
    const opt1 = document.createElement("option");
    opt1.value = i;
    opt1.textContent = i;
    startPageSelect.appendChild(opt1);

    const opt2 = document.createElement("option");
    opt2.value = i;
    opt2.textContent = i;
    endPageSelect.appendChild(opt2);
  }
}



function updateWordlistPageRange() {
  const level = document.getElementById("wordlist-level-select").value;
  let maxPage = 1;
  if (level === "beginner") {
    maxPage = 21;
  } else if (level === "intermediate") {
    maxPage = 34;
  } else if (level === "advanced") {
    maxPage = 2;
  } else if (level === "expressionup") {
    maxPage = 10;
  }

  const startSelect = document.getElementById("wordlist-start-page");
  const endSelect = document.getElementById("wordlist-end-page");

  startSelect.innerHTML = "";
  endSelect.innerHTML = "";

  for (let i = 1; i <= maxPage; i++) {
    const opt1 = document.createElement("option");
    opt1.value = i;
    opt1.textContent = i;
    startSelect.appendChild(opt1);

    const opt2 = document.createElement("option");
    opt2.value = i;
    opt2.textContent = i;
    endSelect.appendChild(opt2);
  }
}

document.addEventListener("DOMContentLoaded", function () {
  updatePageRange();
  updateWordlistPageRange();

  const quizLevel = document.getElementById("quiz-level-select");
  const wordlistLevel = document.getElementById("wordlist-level-select");

  if (quizLevel) {
    quizLevel.addEventListener("change", updatePageRange);
  }

  if (wordlistLevel) {
    wordlistLevel.addEventListener("change", updateWordlistPageRange);
  }
});

// 初級/中級の選択が変更された際にページ範囲を更新
document.getElementById("quiz-level-select").addEventListener("change", updatePageRange);

// 最初にページ範囲を更新（ページロード時や初期状態で呼び出す）
updatePageRange();

	const intermediateStartPageSelect = document.getElementById("intermediate-start-page");
	const intermediateEndPageSelect = document.getElementById("intermediate-end-page");
	// 中級単語のページ範囲 (1~34)
        for (let i = 1; i <= 34; i++) { // 最大ページ数を直接設定
            const startOption = document.createElement("option");
            startOption.value = i;
            startOption.textContent = i;
            // document.getElementById("intermediate-start-page").appendChild(startOption);
            const endOption = document.createElement("option");
            endOption.value = i;
            endOption.textContent = i;
            // document.getElementById("intermediate-end-page").appendChild(endOption);
        }
	const beginnerStartPageSelect = document.getElementById("beginner-start-page");
	const beginnerEndPageSelect = document.getElementById("beginner-end-page");
	// 初級単語のページ範囲 (1~21)
        for (let i = 1; i <= 21; i++) { // 最大ページ数を直接設定

            const startOption = document.createElement("option");
            startOption.value = i;
            startOption.textContent = i;
            // document.getElementById("beginner-start-page").appendChild(startOption);
            const endOption = document.createElement("option");
            endOption.value = i;
            endOption.textContent = i;
            // document.getElementById("beginner-end-page").appendChild(endOption);
        }


        // 出題範囲に基づく単語リストを取得
function getWordsInRange(start, end, onlyIncorrect) {
    return selectedList.filter(word => word.page >= start && word.page <= end && (!onlyIncorrect || word.status === "未暗記"));
}

// クイズ進行状態のフラグを追加
let isQuizInProgress = false;

function showQuizModal(message, onConfirm, onCancel) {
    const modal = document.getElementById("quiz-modal");
    const modalMessage = document.getElementById("modal-message");
    const yesButton = document.getElementById("modal-yes");
    const noButton = document.getElementById("modal-no");

    modalMessage.textContent = message;
    modal.classList.remove("hidden");

    // 「再開」ボタンのクリックイベント
    yesButton.onclick = () => {
        modal.classList.add("hidden");
        onConfirm();
    };

    // 「新しいクイズを開始」ボタンのクリックイベント
    noButton.onclick = () => {
        modal.classList.add("hidden");
        onCancel();
    };
}

function startQuiz() {
    const startPage = parseInt(document.getElementById("start-page").value);
    const endPage = parseInt(document.getElementById("end-page").value);
    const onlyIncorrect = document.getElementById("only-incorrect").checked;
    const isBeginner = document.getElementById("quiz-level-select").value === "beginner"; // 初級選択ボタンがチェックされているか確認

    // 選択された単語リストを設定
    const selectedLevel = document.getElementById("quiz-level-select").value;
	setWordList(selectedLevel);

    if (startPage > endPage) {
        alert("開始ページは終了ページ以下にしてください。");
        return;
    }

    // クイズ進行状況を復元するか、新しく開始するか確認
    const savedQuizState = localStorage.getItem("quizProgress");
    if (completed) {
    // 終了フラグが立っている場合は、確認せずに強制的に新しいクイズを開始
    startNewQuiz();
    } else if (savedQuizState) {
        showQuizModal(
            "前回途中で終了したクイズがあります。再開しますか？",
            () => {
                // 再開処理
                loadQuizProgress();
                isQuizInProgress = true;
                showQuizSection();
                nextQuestion();
            },
            () => {
                // 新しいクイズを開始
                startNewQuiz();
            }
        );
    } else {
        // 新しいクイズを開始
        startNewQuiz();
    }
}
// 新しいクイズを開始する関数
function startNewQuiz() {
    completed = false; // 終了フラグをリセット
    const startPage = parseInt(document.getElementById("start-page").value);
    const endPage = parseInt(document.getElementById("end-page").value);
    const onlyIncorrect = document.getElementById("only-incorrect").checked;
    const isBeginner = document.getElementById("quiz-level-select").value === "beginner"; // 初級選択ボタンがチェックされているか確認
    
    loadAnswersFromStorage();
    quizWords = getWordsInRange(startPage, endPage, onlyIncorrect);

    if (quizWords.length === 0) {
        alert("選択範囲内に単語がありません。");
        return;
    }

    quizWords = shuffleArray(quizWords);
    currentQuizIndex = 0;
    isQuizInProgress = true;

    // 進行状況を初期化
    updateProgress();

    showQuizSection();
    nextQuestion();
}
	function shuffleArray(array) {
    	    for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1)); // ランダムなインデックスを生成
                [array[i], array[j]] = [array[j], array[i]]; // 要素を交換
    	    }
    	return array;
	}

        let quizWords = [];
        let currentQuizIndex = 0;

function endQuiz() {
    alert("クイズが終了しました！");

    // クイズ進行状態をリセット
    isQuizInProgress = false;
    quizWords = [];
    currentQuizIndex = 0;

    // ローカルストレージから進行状況を削除
    localStorage.removeItem("quizProgress");

    // クイズセクションを非表示にして範囲選択画面に戻る
    showRangeSelection();
}

// 回答結果を保存
function saveAnswer(word, status) {
    let storedAnswers = JSON.parse(localStorage.getItem('quizAnswers')) || [];
    const existingAnswerIndex = storedAnswers.findIndex(a => a.word === word.word);
    if (existingAnswerIndex >= 0) {
        storedAnswers[existingAnswerIndex].status = status;
    } else {
        storedAnswers.push({ word: word.word, status: status });
    }
    localStorage.setItem('quizAnswers', JSON.stringify(storedAnswers));
}

// ローカルストレージから解答データを復元し、words配列に反映
function loadAnswersFromStorage() {
    const storedAnswers = JSON.parse(localStorage.getItem('quizAnswers')) || [];
    selectedList.forEach(word => {
        const storedAnswer = storedAnswers.find(a => a.word === word.word);
        if (storedAnswer) {
            word.status = storedAnswer.status; // 正解、不正解、未回答の状態を適用
        }
    });
}

// 自動読み上げ機能の状態をトグルする関数
function toggleAutoSpeak() {
    return document.getElementById("auto-speak").checked;
}
function markAnswer(isCorrect) {
    const word = quizWords[currentQuizIndex]; // 現在の単語
    const resultElement = document.getElementById("result");

    // 意味を表示する
    document.getElementById('meaning').style.display = 'inline';

    // 「次へ」ボタンを表示する
    document.getElementById('next-btn').style.display = 'block';
    // 〇×ボタンを非表示
    document.getElementById('incorrect-btn').style.display = "none";
    document.getElementById('correct-btn').style.display = "none";

    // 正解・不正解の判定処理
    if (isCorrect) {
        resultElement.style.color = "green";
        word.status = "暗記済"; 
    } else {
        resultElement.style.color = "red";
        word.status = "未暗記"; 
    }
    // **ここで currentQuizIndex を更新**
    currentQuizIndex++; // 次の問題へ進む

    saveAnswer(word, word.status); // ステータスを保存

    // 進行状況の更新
    updateProgress();

    // 1秒後に次の問題へ移動する処理をセット（〇ボタンが押された場合は自動で移動）
    if (isCorrect) {
        autoNextTimeout = setTimeout(() => {
            nextQuestion(); // ここを showNextWord() ではなく nextQuestion() にする
        }, 1000);
    }
}
// 一つ前の問題に移動
function moveToPrevious() {
    if (currentQuizIndex > 0) {
        currentQuizIndex--;
        nextQuestion();  // 次の問題に進む処理を呼び出す
    }
}

// 一つ次の問題に移動
function moveToNext() {
    if (currentQuizIndex < quizWords.length - 1) {
        currentQuizIndex++;
        nextQuestion();  // 次の問題に進む処理を呼び出す
    }
}

let currentWord = 0; // フラッシュカードの現在の単語インデックスを初期化
let autoNextTimeout;  // 1秒後の自動移動処理を管理する変数

// 次の問題に進む
function nextQuestion() {
    clearTimeout(autoNextTimeout);  // 1秒後の自動移動をキャンセル

    // クイズが終了した場合、最後の問題の処理を行う
    if (currentQuizIndex >= quizWords.length) {
        alert("フラッシュカード終了！");
        completed = true;  // 終了状態を示すフラグを立てる
        showRangeSelection(); // 範囲選択画面に戻る
        return;
    }

    speechSynthesis.cancel();
    if (speechTimeoutId) {
        clearTimeout(speechTimeoutId);
        speechTimeoutId = null;
    }

    // 現在の単語を設定
    const word = quizWords[currentQuizIndex]; 
   document.getElementById("word").innerHTML = word.word;
    document.getElementById("meaning").innerHTML = word.meaning;
    document.getElementById('meaning').style.display = "none"; 
    document.getElementById("result").innerHTML = "";

    // 「〇×」ボタンを表示
    document.getElementById("incorrect-btn").style.display = "inline-block";
    document.getElementById("correct-btn").style.display = "inline-block";
    document.getElementById("next-btn").style.display = "none"; // 次へボタン非表示

    saveQuizProgress();
    updateProgress();  // 進行状況を更新

    // 自動読み上げ機能がオンなら単語を2回読み上げ
    if (toggleAutoSpeak()) {
        playWord(word.word);

        // 2回目の再生タイマーを設定
        speechTimeoutId = setTimeout(() => {
            if (currentQuizIndex === quizWords.indexOf(word)) {
                playWord(word.word);
            }
        }, 2500);
    }
}

// 進行状況の更新
function updateProgress() {
    const totalQuestions = quizWords.length;
    const answeredQuestions = currentQuizIndex + 1; // 進行状況の表示は1からカウント
    const progressText = `${answeredQuestions}/${totalQuestions}`;
    
    document.getElementById('progress').textContent = progressText; // 進行状況を表示
}

// 「戻る」ボタンを押した際の処理
function showRangeSelection() {
    hideAllSections();
    document.getElementById("range-selection").classList.remove("hidden");

    // クイズ進行中でも単語リストや進捗はリセットしない
}
function saveQuizProgress() {
    const quizState = {
        currentQuizIndex: currentQuizIndex,
        quizWords: quizWords
    };
    localStorage.setItem("quizProgress", JSON.stringify(quizState));
}

function loadQuizProgress() {
    const quizState = JSON.parse(localStorage.getItem("quizProgress"));
    if (quizState) {
        quizWords = quizState.quizWords || [];
        currentQuizIndex = quizState.currentQuizIndex || 0;
    } else {
        quizWords = [];
        currentQuizIndex = 0;
    }
}


let speechTimeoutId; // 音声再生タイマーのID  
let currentWordIndex = 0; // 現在の再生対象単語のインデックス  
let isAudioUnlocked = false; // ブラウザの音声再生が許可されたかどうか
let isPlaying = false; // 現在の音声再生状態

// ページロード時に無音を再生（iOSの制限を回避）
//window.addEventListener("load", () => {
//    let silentAudio = new Audio();
//    silentAudio.src = "data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=";
//    silentAudio.play().catch(() => {});
//}); 
function playWord(word) {
    if (!word) {
        alert("単語が指定されていません。");
        return;
    }

    const url = `https://translate.google.com/translate_tts?ie=UTF-8&tl=ko&client=tw-ob&q=${encodeURIComponent(word)}`;
    const audio = new Audio(url);

    if (isPlaying) return; // 既に再生中なら再生しない

    isPlaying = true;
    audio.play().then(() => {
        lastPlayedWord = word; 
        console.log(`再生中: ${word}`);
    }).catch((error) => {
        alert("音声の再生に失敗しました: " + error.message);
    });

    audio.onended = () => {
        isPlaying = false;
    };
    lastPlayedWord = word; // 最後に再生された単語を記録
}

// グローバル変数：最後に再生された単語
let lastPlayedWord = "";
document.addEventListener("keydown", function(event) {
    if (event.shiftKey) {
        if (event.key === "ArrowUp" || event.key === "ArrowDown") {
            if (currentWordIndex >= 0 && currentWordIndex < selectedList.length) {
                let wordToPlay = selectedList[currentWordIndex].word;
                lastPlayedWord = wordToPlay; // 矢印キーで再生した単語を記録
                playWord(wordToPlay);
            }
        }
    }
});
// Shiftキー単独で最後に再生した単語を再生
document.addEventListener("keydown", function(event) {
    if (event.key === "Shift" && lastPlayedWord) {
        playWord(lastPlayedWord);
    }
});
// Shiftキーの処理
document.addEventListener("keydown", function (event) {
    if (event.key === "Shift" && lastPlayedWord) {
        // クイズ中かどうかを判定
        const isQuizActive = !document.getElementById("quiz-section").classList.contains("hidden");

        if (isQuizActive) {
            // クイズ中の場合：現在の問題の単語を再生
            const word = quizWords[currentQuizIndex - 1]; // 現在の問題の単語を取得
            playWord(word.word);
        } else {
            // 単語一覧表示中の場合：最後に再生された単語を再生
            if (lastPlayedWord) {
                playWord(lastPlayedWord);
            }
        }
    }
});
// 矢印キーの処理
document.addEventListener("keydown", function (event) {
    // クイズ中の場合は矢印キーの処理を無効化
    if (!document.getElementById("quiz-section").classList.contains("hidden")) {
        return;
    }

    const wordListRows = document.querySelectorAll("#word-list-body tr");
    if (wordListRows.length === 0) return; // 単語リストが空の場合は何もしない

    if (event.key === "ArrowDown") {
        // →キーで次の単語を再生
        if (currentWordIndex === -1 || currentWordIndex <= 0) {
            // まだ再生していない場合 or 一番下にいる場合 → 一番上の単語を再生
            currentWordIndex = 0;
        } else if (currentWordIndex < wordListRows.length - 1) {
            currentWordIndex++;
        }
        const nextWord = wordListRows[currentWordIndex]
            .querySelector("td:first-child")
            .textContent.trim()
            .replace(/🔊/, ""); // スピーカーマークを除去
        playWord(nextWord);
        lastPlayedWord = nextWord; // 最後に再生された単語を更新
    } else if (event.key === "ArrowUp") {
        // ←キーで前の単語を再生
        if (currentWordIndex > 0) {
            currentWordIndex--;
        }
        const prevWord = wordListRows[currentWordIndex]
            .querySelector("td:first-child")
            .textContent.trim()
            .replace(/🔊/, ""); // スピーカーマークを除去
        playWord(prevWord);
        lastPlayedWord = prevWord; // 最後に再生された単語を更新
    }
});
function playPreviousWord() {
    const wordListRows = document.querySelectorAll("#word-list-body tr");
    if (wordListRows.length === 0) return; // 単語リストが空なら何もしない

    if (currentWordIndex > 0) {
        currentWordIndex--;
    }
    const prevWord = wordListRows[currentWordIndex]
        .querySelector("td:first-child")
        .textContent.trim()
        .replace(/🔊/, ""); // スピーカーマークを除去
    playWord(prevWord);
    lastPlayedWord = prevWord; // 最後に再生された単語を更新
}

// スクロール量（ピクセル単位）
const scrollStep = 42;

// 表のスクロールを行う関数
function scrollTable(direction) {
    const scrollableTable = document.getElementById("scrollable-table");
    if (direction === "down") {
        scrollableTable.scrollTop += scrollStep;
    } else if (direction === "up") {
        scrollableTable.scrollTop -= scrollStep;
    }
}

// 単語を再生（`currentWordIndex` の変更はここでは行わない）
function playWordAtIndex(index, wordListRows) {
    if (!wordListRows || wordListRows.length === 0 || index < 0 || index >= wordListRows.length) return;

    const word = wordListRows[index]
        .querySelector("td:first-child")
        .textContent.trim()
        .replace(/🔊/, ""); // スピーカーマークを除去

    playWord(word);
    lastPlayedWord = word;
    currentWordIndex = index;
}

// ボタンのクリックイベント
document.getElementById("up-button").addEventListener("click", () => {
    const wordListRows = document.querySelectorAll("#word-list-body tr:not([style*='display: none'])");
    if (currentWordIndex > 0) {
        currentWordIndex--;
    }
    playWordAtIndex(currentWordIndex, wordListRows);
    scrollTable("up");
});
document.getElementById("down-button").addEventListener("click", () => {
    const wordListRows = document.querySelectorAll("#word-list-body tr:not([style*='display: none'])");
    if (currentWordIndex < wordListRows.length - 1) {
        currentWordIndex++;
    }
    playWordAtIndex(currentWordIndex, wordListRows);
    scrollTable("down");
});

function repeatLastWord() {
    if (lastPlayedWord) {
        playWord(lastPlayedWord);
    }
}
////////////////////// 単語一覧の表示関数/////////////////////////////////////////////
    // 韓国語の表示/非表示を切り替える関数
    function toggleKorean() {
        const isChecked = document.getElementById("toggle-korean").checked;
        document.querySelectorAll("#word-list-body tr td:first-child").forEach(td => {
            td.classList.toggle("hidden-korean", isChecked);
        });
    }
    // 意味の表示/非表示を切り替える関数
    function toggleMeaning() {
        const isChecked = document.getElementById("toggle-meaning").checked;
        document.querySelectorAll("#word-list-body tr td:nth-child(2)").forEach(td => {
            td.classList.toggle("hidden-meaning", isChecked);
        });
    }
// document.getElementById("beginner-word-list-btn").addEventListener("click", function () {
//     let shuffle = document.getElementById("shuffle-beginner-words").checked;
//     displayWordList("beginner", shuffle);
// });

// document.getElementById("intermediate-word-list-btn").addEventListener("click", function () {
//     let shuffle = document.getElementById("shuffle-intermediate-words").checked;
//     displayWordList("intermediate", shuffle);
// });
// 「中級単語一覧を見る」ボタン
// function showIntermediateWordList() {
//     setWordList('intermediate');

//     const startPage = parseInt(document.getElementById("intermediate-start-page").value);
//     const endPage = parseInt(document.getElementById("intermediate-end-page").value);

//     if (startPage > endPage) {
//         alert("開始ページは終了ページ以下にしてください。");
//         return;
//     }

//     const filteredWords = selectedList.filter(word => word.page >= startPage && word.page <= endPage);
//     if (filteredWords.length === 0) {
//         alert("選択範囲内に単語がありません。");
//         return;
//     }

//     showWordList(filteredWords, "intermediate"); // 中級レベルを指定
// }
// // 「初級単語一覧を見る」ボタン
// function showBeginnerWordList() {
//     setWordList('beginner');

//     const startPage = parseInt(document.getElementById("beginner-start-page").value);
//     const endPage = parseInt(document.getElementById("beginner-end-page").value);

//     if (startPage > endPage) {
//         alert("開始ページは終了ページ以下にしてください。");
//         return;
//     }

//     const filteredWords = selectedList.filter(word => word.page >= startPage && word.page <= endPage);
//     if (filteredWords.length === 0) {
//         alert("選択範囲内に単語がありません。");
//         return;
//     }

//     showWordList(filteredWords, "beginner"); // 初級レベルを指定
// }
function playWordFromSpeaker(word) {
    // 単語再生
    playWord(word);

    // 再生した単語がリスト内の何番目かを探して currentWordIndex を更新
    const wordListRows = document.querySelectorAll("#word-list-body tr:not([style*='display: none'])");
    for (let i = 0; i < wordListRows.length; i++) {
        const rowWord = wordListRows[i].querySelector("td:first-child").textContent.trim().replace(/🔊/, "");
        if (rowWord === word) {
            currentWordIndex = i;
            break;
        }
    }
}

function showSelectedWordList() {
    const level = document.getElementById("wordlist-level-select").value;
    setWordList(level);

    const startPage = parseInt(document.getElementById("wordlist-start-page").value);
    const endPage = parseInt(document.getElementById("wordlist-end-page").value);
    const shuffle = document.getElementById("wordlist-shuffle").checked;

    if (startPage > endPage) {
        alert("開始ページは終了ページ以下にしてください。");
        return;
    }

    const filteredWords = selectedList.filter(word => word.page >= startPage && word.page <= endPage);
    if (shuffle) {
        filteredWords.sort(() => Math.random() - 0.5);
    }

    showWordList(filteredWords, level);
}

function displayWordList(level, shuffle) {
	let wordList;
    if (level === "beginner") {
        wordList = beginnerWords;
    } else if (level === "intermediate") {
        wordList = intermediateWords;
    } else if (level === "advanced") {
        wordList = advancedWords;
    } else if (level === "expression") {
        wordList = expressionUpWords;
    }

    if (shuffle) {
        wordList = [...wordList].sort(() => Math.random() - 0.5);
    }
    showWordList(wordList, level); // ここで level を渡す
}
// 単語一覧表示関数（ローカルストレージのデータを適用）
function showWordList(filteredWords, level) {
    currentWordIndex = 0;
    loadAnswersFromStorage();
    hideAllSections();

    let shuffleCheckbox = document.getElementById("wordlist-shuffle");
    if (!shuffleCheckbox) return;

    if (shuffleCheckbox.checked) {
        filteredWords = [...filteredWords].sort(() => Math.random() - 0.5);
    }

    const wordListBody = document.getElementById("word-list-body");
    wordListBody.innerHTML = "";

    filteredWords.forEach(word => {
        let statusClass = "";
        let statusText = "";
        if (word.status === "暗記済") {
            statusClass = "green";
            statusText = "〇";
        } else if (word.status === "未暗記") {
            statusClass = "red";
            statusText = "×";
        }

        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${word.word}  <span onclick="playWordFromSpeaker('${word.word}')" style="font-size: 12px; cursor: pointer;">🔊</span></td>
            <td>${word.meaning}</td>
            <td class="${statusClass}" onclick="toggleWordStatus(this, '${word.word}')">${statusText}</td>
        `;
        wordListBody.appendChild(row);
    });

    filterWordList();
    document.getElementById("word-list").classList.remove("hidden");
}

function toggleWordStatus(cell, wordText) {
    let currentStatus = cell.textContent.trim();
    let newStatus = "";
    let newClass = "";

    if (currentStatus === "〇") {
        newStatus = "×";
        newClass = "red";
    } else if (currentStatus === "×") {
        newStatus = "";
        newClass = "";
    } else {
        newStatus = "〇";
        newClass = "green";
    }

    // セルの見た目を更新
    cell.textContent = newStatus;
    cell.className = newClass;

    // データ構造を更新
    const wordObj = selectedList.find(w => w.word === wordText);
    if (wordObj) {
        if (newStatus === "〇") {
            wordObj.status = "暗記済";
        } else if (newStatus === "×") {
            wordObj.status = "未暗記";
        } else {
            delete wordObj.status;
        }
    }

    // localStorageに保存
    let storedAnswers = JSON.parse(localStorage.getItem('quizAnswers')) || [];
    const existing = storedAnswers.find(a => a.word === wordText);
    if (existing) {
        if (newStatus === "") {
            storedAnswers = storedAnswers.filter(a => a.word !== wordText);
        } else {
            existing.status = newStatus === "〇" ? "暗記済" : "未暗記";
        }
    } else if (newStatus !== "") {
        storedAnswers.push({
            word: wordText,
            status: newStatus === "〇" ? "暗記済" : "未暗記"
        });
    }
    localStorage.setItem("quizAnswers", JSON.stringify(storedAnswers));

    // フィルターが有効な場合は再適用
    // filterWordList();
}

document.addEventListener("DOMContentLoaded", function () {
  const btn = document.getElementById("word-list-show-btn");
  if (btn) {
    btn.addEventListener("click", showSelectedWordList); 
  }
});

document.addEventListener("DOMContentLoaded", function () {
    const scrollableTable = document.getElementById("scrollable-table");

    // iPadでもフォーカスを当てられるようにする
    scrollableTable.addEventListener("click", () => {
        scrollableTable.focus();
    });

});

// document.addEventListener('DOMContentLoaded', function() {
//     // ボタンのクリックイベントリスナーをここで追加
//     document.getElementById("intermediate-word-list-btn").addEventListener("click", showIntermediateWordList);
//     document.getElementById("beginner-word-list-btn").addEventListener("click", showBeginnerWordList);
//     document.getElementById("start-page").focus();
// });

// 範囲を基に単語一覧を表示する関数
function showFilteredWordList() {
    const startPage = parseInt(wordListStartPageSelect.value);
    const endPage = parseInt(wordListEndPageSelect.value);
    if (startPage > endPage) {
        alert("開始ページは終了ページ以下にしてください。");
        return;
    }
    // 現在選択されているリストを取得
    const filteredWords = selectedList.filter(word => word.page >= startPage && word.page <= endPage);
    if (filteredWords.length === 0) {
        alert("選択範囲内に単語がありません。");
        return;
    }
    showWordList(filteredWords);
}
function filterWordList() {
    const hideCorrect = document.getElementById("hide-correct").checked;
    const hideIncorrect = document.getElementById("hide-incorrect").checked;
    const hideUnattempted = document.getElementById("hide-unattempted").checked;
    const wordListBody = document.getElementById("word-list-body");
    const rows = wordListBody.querySelectorAll("tr");

    rows.forEach(row => {
        const correctCell = row.querySelector("td:nth-child(3)"); // 正解/不正解状態を表示するセル
        const statusText = correctCell.textContent;
        let hideRow = false;
        if (hideCorrect && statusText === "〇") {
            hideRow = true;
        }
        if (hideIncorrect && statusText === "×") {
            hideRow = true;
        }
        if (hideUnattempted && statusText === "") {
            hideRow = true;
        }
        // 行を非表示にする
        row.style.display = hideRow ? "none" : "";
    });
}
        // セクションの表示切り替え
        function showRangeSelection() {
            hideAllSections();
            document.getElementById("range-selection").classList.remove("hidden");
        }
        function showQuizSection() {
            hideAllSections();
            document.getElementById("quiz-section").classList.remove("hidden");
        }
        function hideAllSections() {
            document.querySelectorAll(".section, .table-container").forEach(section => {
                section.classList.add("hidden");
            });
        }
        showRangeSelection();
////ファイル進捗出力///////////////////////////////////////////////////////////////////////////
function exportProgress() {
    const answers = JSON.parse(localStorage.getItem("quizAnswers")) || [];
    const jsonString = JSON.stringify(answers, null, 2);

    const outputArea = document.getElementById("json-output");
    const textArea = document.getElementById("json-text");

    textArea.value = jsonString;
    outputArea.classList.remove("hidden");
    textArea.scrollTop = 0;
    textArea.select(); // 自動で全選択

    showToast("コピーして保存してください！");
}

function importProgress(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        try {
            const data = JSON.parse(e.target.result);
            if (Array.isArray(data)) {
                localStorage.setItem("quizAnswers", JSON.stringify(data));
                showToast("暗記状況を読み込みました！");
                setTimeout(() => location.reload(), 1000);
            } else {
                alert("ファイルの形式が正しくありません。");
            }
        } catch (error) {
            alert("読み込みに失敗しました。JSON形式のファイルを選んでください。");
        }
    };
    reader.readAsText(file);
}

function showToast(message) {
    const toast = document.getElementById("toast");
    toast.textContent = message;
    toast.classList.remove("hidden");
    toast.classList.add("show");

    setTimeout(() => {
        toast.classList.remove("show");
        setTimeout(() => toast.classList.add("hidden"), 500);
    }, 1500);
}
    

function copyToClipboard() {
    const textArea = document.getElementById("json-text");
    textArea.select();
    document.execCommand("copy");
    showToast("コピーしました！");
}</script>
</div></body>
</html>
